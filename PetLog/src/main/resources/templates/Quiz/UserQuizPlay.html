<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:replace="~{top::menu}"></div>
<head>
    <style>
        body {
          background-color: #f9f4fc;
          margin-top: 20px;
          padding: 0;
          font-family: 'Pretendard', sans-serif;
          color: #333;
        }

        .quiz-insert-wrapper {
          text-align: center;
          margin: 30px 0 5px;
        }

        .quiz-insert-link {
          display: inline-block;
          font-size: 15px;
          text-decoration: none;
          color: #8658a8;
          font-weight: 500;
        }

        .quiz-insert-link:hover {
          text-decoration: underline;
        }

        .quiz-form {
          background: #ffffff;
          padding: 30px 40px;
          margin: 20px auto;
          width: 90%;
          max-width: 600px;
          border-radius: 16px;
          box-shadow: 0 8px 20px rgba(200, 160, 220, 0.15);
          border: 1px solid #ebd9f4;
          text-align: left;
        }

        .quiz-title {
          font-size: 1.4em;
          color: #8658a8;
          margin-bottom: 20px;
          text-align: center;
        }

        .quiz-option {
          display: block;
          margin: 12px 0;
          font-size: 1.05em;
          background: #fff7f4;
          padding: 12px 16px;
          border-radius: 10px;
          transition: background-color 0.2s;
          cursor: pointer;
          border: 1px solid #f6d8e7;
        }

        .quiz-option:hover {
          background: #fde3ec;
        }

        .quiz-option input {
          margin-right: 10px;
          transform: scale(1.1);
          accent-color: #c59cf3;
        }

        .quiz-submit {
          margin-top: 25px;
          display: block;
          width: 100%;
          padding: 12px;
          background: #d9c7f3;
          color: #fff;
          font-size: 1.05em;
          border: none;
          border-radius: 10px;
          cursor: pointer;
          transition: 0.3s;
          font-weight: bold;
        }

        .quiz-submit:hover {
          background: #c29ee4;
        }

        .quiz-hint {
          font-size: 0.95em;
          color: #666;
          text-align: center;
          margin-top: 14px;
          font-weight: 500;
        }
    </style>
</head>
<body>
<!--ê´€ë¦¬ì ì „ìš©ë²„íŠ¼ -->
<div th:if="${session.userRole == 'admin'}" class="quiz-insert-wrapper">
    <a th:href="@{/QuizInput}" class="quiz-insert-link">í€´ì¦ˆ ë“±ë¡</a>
    <a th:href="@{/QuizOut}" class="quiz-insert-link">í€´ì¦ˆ ëª©ë¡</a>
</div>

<!-- í€´ì¦ˆ ì¶œë ¥ -->
<div th:each="dto : ${dto}">
    <form th:action="@{/QuizSave}" method="post" class="quiz-form" onsubmit="return onSubmitQuiz(this)">
        <input type="hidden" name="quizId" th:value="${dto.quizId}" />
        <input type="hidden" name="resultTime" id="resultTime" />

        <h3 class="quiz-title">â“ <span th:text="${dto.quizQuestion}">ë¬¸ì œ ì§ˆë¬¸</span></h3>

        <label class="quiz-option">
            <input type="radio" name="quizAnswer" value="1" required>
            <span th:text="${dto.quizOption1}">ë³´ê¸° 1</span>
        </label>
        <label class="quiz-option">
            <input type="radio" name="quizAnswer" value="2" required>
            <span th:text="${dto.quizOption2}">ë³´ê¸° 2</span>
        </label>
        <label class="quiz-option">
            <input type="radio" name="quizAnswer" value="3" required>
            <span th:text="${dto.quizOption3}">ë³´ê¸° 3</span>
        </label>
        <label class="quiz-option">
            <input type="radio" name="quizAnswer" value="4" required>
            <span th:text="${dto.quizOption4}">ë³´ê¸° 4</span>
        </label>

        <button type="submit" class="quiz-submit">ì œì¶œí•˜ê¸°</button>
        <p class="quiz-hint">â± í’€ì´ ì‹œê°„ì€ ìë™ìœ¼ë¡œ ê¸°ë¡ë©ë‹ˆë‹¤</p>
    </form>
</div>

<!-- ëª¨ë“  í€´ì¦ˆ ì™„ë£Œ ì‹œ -->
<div th:if="${allDone}">
    <script>
        alert("ğŸ‰ ëª¨ë“  í€´ì¦ˆë¥¼ ì™„ë£Œí–ˆìŠµë‹ˆë‹¤! í™ˆìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤.");
        window.location.href = "/main";
    </script>
</div>

<script>
    const startTime = Date.now();
    function onSubmitQuiz(form) {
      const endTime = Date.now();
      const elapsed = Math.floor((endTime - startTime) / 1000);
      form.querySelector("input[name='resultTime']").value = elapsed;
      return true;
    }
</script>

</body>
</html>